{{ 'component-card.css' | asset_url | stylesheet_tag }}

<div class="page-width section-{{ section.id }}-padding">
  <h1 class="title title--primary center" style="text-align: center; margin-bottom: 4rem;">{{ section.settings.title | escape }}</h1>

  {%- liquid
    case section.settings.sort
      when 'products_high', 'products_low'
        assign collections = collections | sort: 'all_products_count'
      when 'date', 'date_reversed'
        assign collections = collections | sort: 'published_at'
    endcase

    if section.settings.sort == 'products_high' or section.settings.sort == 'date_reversed' or section.settings.sort == 'alphabetical_reversed'
      assign collections = collections | reverse
    endif
  -%}

  <ul class="grid grid--{{ section.settings.columns_desktop }}-col-desktop grid--1-col-tablet-down" role="list" style="display: grid; grid-template-columns: repeat({{ section.settings.columns_desktop }}, 1fr); gap: 2rem; list-style: none; padding: 0;">
    {%- for collection in collections -%}
      <li class="grid__item">
        <a href="{{ collection.url }}" class="card-wrapper" style="display: block; text-decoration: none; position: relative;">
          <div class="card__inner" style="border-radius: var(--radius-md); overflow: hidden; background: #f5f5f7;">
            <div class="media media--transparent" style="padding-bottom: 100%;">
              {%- if collection.featured_image != blank -%}
                <img src="{{ collection.featured_image | image_url: width: 533 }}" alt="{{ collection.title }}" loading="lazy" style="width: 100%; height: 100%; object-fit: cover; transition: transform 0.5s ease;">
              {%- else -%}
                {{ 'collection-1' | placeholder_svg_tag: 'placeholder-svg' }}
              {%- endif -%}
            </div>
            <div class="card__content" style="position: absolute; bottom: 0; left: 0; right: 0; padding: 2rem; background: linear-gradient(to top, rgba(0,0,0,0.6), transparent); color: #fff;">
              <h3 class="card__heading h3" style="color: #fff; margin: 0;">{{ collection.title }} {% render 'icon-arrow' %}</h3>
              <p style="font-size: 1.2rem; opacity: 0.8; margin-top: 5px;">{{ collection.all_products_count }} Products</p>
            </div>
          </div>
        </a>
      </li>
    {%- endfor -%}
  </ul>
</div>

{% schema %}
{
  "name": "Collections List",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Heading",
      "default": "Collections"
    },
    {
      "type": "select",
      "id": "sort",
      "options": [
        { "value": "alphabetical", "label": "Alphabetically, A-Z" },
        { "value": "alphabetical_reversed", "label": "Alphabetically, Z-A" },
        { "value": "date_reversed", "label": "Date, new to old" },
        { "value": "date", "label": "Date, old to new" },
        { "value": "products_high", "label": "Product count, high to low" },
        { "value": "products_low", "label": "Product count, low to high" }
      ],
      "default": "alphabetical",
      "label": "Sort collections by:"
    },
    {
      "type": "range",
      "id": "columns_desktop",
      "min": 1,
      "max": 5,
      "step": 1,
      "default": 3,
      "label": "Number of columns on desktop"
    }
  ]
}
{% endschema %}